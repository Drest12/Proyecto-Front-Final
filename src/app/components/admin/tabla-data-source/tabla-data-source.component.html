<div class="card-body">
  <div class="mat-elevation-z8">
    <button *ngIf="checkedAction" [disabled]="selection.selected.length ==0" mat-raised-button style="float:right;"
      class="bg-primary relative m-1" (click)="FuncionbtnGenAsiento()">
      Generar Asiento</button>
    <div class="body" [style.height]="bodyheight"
      [ngStyle]="maxHeight ? {'max-height': 'calc(100vh - 326px)'} : {'max-height': 'calc(100vh - 161px)'}">
      <table class="table-responsive tablita w-100" mat-table [dataSource]="dataSource" matSort>
        <ng-container *ngFor="let columna of cabecera,let i=index" [matColumnDef]="columna"
          style="white-space: nowrap;">
          <!-- cabecera -->
          <ng-container *ngIf="columna === 'Acciones'">
            <th mat-header-cell *matHeaderCellDef> <!-- [style.width]="size[i] + '%'"-->
              {{columna}}
            </th>
          </ng-container>
          <ng-container *ngIf="columna !== 'Acciones'">
            <!--Inicio cuando si existe el check de columnas-->
            <ng-container *ngIf="existeCheckColumn;else noExisteCheckColumn">
              <ng-container *ngIf="datoscheckColumnas.includes(columna); else sincheck">
                <ng-container *ngIf="checkedAction; else solo_Ordenar">
                  <th mat-header-cell *matHeaderCellDef [style.width]="size[i] + '%'" style="white-space: nowrap;">
                    <mat-checkbox #checkboxElem (change)="masterToggle(checkboxElem,relacion[columna])"
                      [indeterminate]="checkedItems[relacion[columna]] && !isAllSelected()">{{
                      columna }}</mat-checkbox>
                  </th>
                </ng-container>
                <ng-template #solo_Ordenar>
                  <th mat-header-cell *matHeaderCellDef [style.width]="size[i] + '%'" style="white-space: nowrap;">
                    <mat-checkbox [checked]="checkedItems[relacion[columna]]"
                      (change)="opcionCheck(relacion[columna])">{{
                      columna }}</mat-checkbox>
                  </th>
                </ng-template>
              </ng-container>
              <ng-template #sincheck>
                <th mat-header-cell *matHeaderCellDef [mat-sort-header]="relacion[columna]"
                  [style.width]="size[i] + '%'" style="white-space: nowrap;">
                  {{ columna }}
                </th>
              </ng-template>
            </ng-container>
            <!--Fin cuando si existe el check de columnas-->

            <!--Inicio cuando no existe el check de columnas-->
            <ng-template #noExisteCheckColumn>
              <th mat-header-cell *matHeaderCellDef [mat-sort-header]="relacion[columna]" [style.width]="size[i] + '%'"
                style="white-space: nowrap;">
                {{ columna }}
              </th>
            </ng-template>
            <!--Fin cuando no existe el check de columnas-->


          </ng-container>
          <!-- cuerpo -->
          <td mat-cell *matCellDef="let row;let i= index;" style="white-space: nowrap;">
            <!-- botones -->

            <ng-container *ngIf="columna === 'Acciones'" class="botones">
              <button mat-button *ngIf="editar" (click)="FuncionbtnEditar(row)" class="botones"
                [disabled]="estadosProgramacion">
                <mat-icon>edit</mat-icon>
              </button>
              <button *ngIf="restaurar" class="botones">
                <mat-icon>restore</mat-icon>
              </button>
              <button (click)="FuncionbtnConsultar(row)" mat-button color="primary" *ngIf="view" class="botones">
                <mat-icon>visibility</mat-icon>
              </button>
              <button (click)="FuncionbtnAprobar(row)" mat-button color="primary" *ngIf="aprobar" class="botones">
                <mat-icon style="color: green;">check_circle_outline</mat-icon>
              </button>
              <button (click)="FuncionbtnDesaprobar(row)" mat-button color="primary" *ngIf="desaprobar" class="botones">
                <mat-icon style="color: red;">cancel</mat-icon>
              </button>
              <button (click)="FuncionbtnEjecucion(row)" mat-button color="primary" *ngIf="ejecucion" class="botones">
                <mat-icon style="color: green;">settings_applications</mat-icon>
              </button>
              <button
                [disabled]="desabilitado ? btnDehabilitado === this.datosTabla.indexOf(row): false || estadosProgramacion"
                (click)="FuncionbtnEliminar(row)" mat-button color="warn" *ngIf=" eliminar" class="botones">
                <mat-icon>delete</mat-icon>
              </button>
              <button *ngIf="print" class="botones print" (click)="FuncionbtnPrint(row)">
                <mat-icon>print</mat-icon>
              </button>
              <button *ngIf="copia" class="botones" (click)="FuncionbtnCopia(row)" style="background: white; border: none;">
                <mat-icon>file_copy</mat-icon>
              </button>
              <button (click)="FuncionbtnAgregarEjer(row)" mat-button *ngIf="addEjer" class="botones">
                <mat-icon>library_add</mat-icon>
              </button>
              <button (click)="FuncionbtnConsultarEjer(row)" mat-button *ngIf="viewEjer" class="botones">
                <mat-icon>library_books</mat-icon>
              </button>
              <button mat-button *ngIf="pago" (click)="MetodoDePago(row)" class="botones">
                <span class='material-icons'>account_balance</span>
              </button>
              <!--   <button mat-button *ngIf="pruebita(condicionIcon, row)" class="botones">
                <span class='material-icons'>account_balance</span>
              </button> -->


              <button (click)="FuncionbtnAddCredSunt(row)" mat-button *ngIf="addCred" class="botones">
                <mat-icon>queue_play_next</mat-icon>
              </button>
            </ng-container>
            <!-- data -->

            <ng-container *ngIf="columna !== 'Acciones'">
              <ng-container *ngIf="checkedAction && columna=='Tipo CP'">
                <mat-checkbox  (change)="selectRow(row)"
                  [checked]="selection.isSelected(row)"></mat-checkbox>
              </ng-container>
              <div [ngClass]="{'descripcion': columna == 'DescripciÃ³n'}" [ngStyle]="relacion[columna]?.includes('_imp') ? {'text-align': 'right'} : {}"
                *ngIf="pipes != undefined && pipes[columna] != undefined; else elseBlock">
                  {{
                  relacion[columna]?.split('.').reduce(aea, row) | dinamoPipe : pipes[columna][0] : pipes[columna][1]
                  }}
              </div>
              <ng-template #elseBlock>
                {{
                relacion[columna]?.split('.').reduce(aea, row)
                }}
              </ng-template>
            </ng-container>
          </td>
        </ng-container>
        <!-- footer -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky:true" class="encabezado"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="row-data"></tr>

        <tr *matNoDataRow>
          <td colspan="4" style="padding-top: 10px; padding-left: 10px;">
            No se encontraron resultados para "{{this.searchText}}"
          </td>
        </tr>
      </table>
      <!-- paginador -->
      <mat-paginator #paginator [pageSizeOptions]="paginaSize" aria-label="Select page of users"></mat-paginator>
    </div>
  </div>
</div>
